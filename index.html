<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="main.css">
		<script src="jquery-2.2.0.min.js"></script>
		<script src="peg-0.9.0.min.js"></script>
		<script src="jsDump.js"></script>
		<script>
			var parser;
			
			$(function() {
				$.ajax({
					type: "GET",
					url: "fluorite5.pegjs",
					dataType: "text",
					success: function(data) {
						parser = PEG.buildParser(data);
						$('#src').keyup(changed);
						$("#src").val("Damage: \\2d+4\\");
						changed();
					},
					error: function(XMLHttpRequest, textStatus, errorThrown) {
						$("#src").val("Status: " + textStatus);
					},
				})
			});
			
			var src;
			function changed()
			{
				var src2 = $("#src").val();
				if (src === src2) return;
				
				src = src2;
				try {
					$("#dest").val(jsDump.parse(parser.parse(src)));
				} catch(e) {
					$("#dest").val(e);
				}
			}
			
		</script>
	</head>
	<body>
		<div id="container">
			<table>
				<tr id="tr_textarea">
					<td><textarea id="src"></textarea></td>
					<td><textarea id="dest"></textarea></td>
				</tr>
				<tr>
					<td colspan="2">
						Browser: Mozilla Firefox 44.0
					</td>
				</tr>
			</table>
		</div>
	</body>
</html>